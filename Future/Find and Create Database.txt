Imports System.Data.OleDb
Imports System.IO

Public Class Form1

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Dim dbFile As String = "R:\Quality\GageCalibration\GTDatabase.accdb"
        Dim connectionString As String = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & dbFile & ";"
        If Not File.Exists(dbFile) Then
            CreateDatabase(dbFile)
        End If
        CheckAndCreateTables(connectionString)
        LoadStatusOptions() ' Your existing method
    End Sub

    Private Sub CreateDatabase(dbFile As String)
        ' ADOX code or alternative method to create an Access database file
        ' This is less common in pure .NET but you can create an empty .accdb file manually or use pre-existing templates
    End Sub

    Private Sub CheckAndCreateTables(connectionString As String)
        Using conn As New OleDbConnection(connectionString)
            conn.Open()
            ' Check if a specific table exists, if not create it
            Dim checkTableCmd As New OleDbCommand("SELECT COUNT(*) FROM Information_Schema.Tables WHERE Table_Name = 'CalibrationTracker'", conn)
            If Convert.ToInt32(checkTableCmd.ExecuteScalar()) = 0 Then
                ' Create the CalibrationTracker table if it doesn't exist
                Dim createTableCmd As New OleDbCommand("CREATE TABLE CalibrationTracker (GageID TEXT, PartNumber TEXT, Status TEXT, Description TEXT, Department TEXT, [Gage Type] TEXT, Customer TEXT, [Calibrated By] TEXT, [Interval (Months)] INTEGER, [Inspected Date] DATE, [Due Date] DATE, Comments TEXT)", conn)
                createTableCmd.ExecuteNonQuery()
            End If
            ' Repeat for other tables like 'Status'
            ' Note: Adjust SQL based on actual required schema
        End Using
    End Sub

    ' ... rest of your Form1 code ...
End Class
